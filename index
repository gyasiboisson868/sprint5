import subprocess
import sys
import argparse

def main():
    # Set up argument parser
    parser = argparse.ArgumentParser(description='Add, commit, and push changes to a Git repository.')
    parser.add_argument('-m', '--message', type=str, help='Commit message')

    args = parser.parse_args()

    # Step 1: Add changes to git
    try:
        subprocess.run(['git', 'add', '.'], check=True)
        print("Changes added to staging area.")
    except subprocess.CalledProcessError:
        print("Error adding changes.")
        sys.exit(1)

    # Step 2: Commit changes
    commit_message = args.message if args.message else 'Automated commit'
    try:
        subprocess.run(['git', 'commit', '-m', commit_message], check=True)
        print(f"Committed changes with message: '{commit_message}'")
    except subprocess.CalledProcessError:
        print("Error committing changes.")
        sys.exit(1)

    # Step 3: Push changes
    try:
        subprocess.run(['git', 'push'], check=True)
        print("Changes pushed to remote repository.")
    except subprocess.CalledProcessError:
        print("Error pushing changes.")
        sys.exit(1)

if __name__ == '__main__':
    main()
